direktiv_api: workflow/v1
description: |
  Stores an intial set of persons in a namespace variable
functions:
  - id: http-request
    image: direktiv/http-request:dev
    type: knative-workflow
states:
  - id: get-fake-persons
    type: action
    action:
      function: http-request
      input:
        method: "GET"
        headers:
          "x-api-key": "reqres-free-v1"
        url: "https://reqres.in/api/users"
    transform: "jq({data: .return[0].result.data, total: 10})"
    transition: store-data
  - id: store-data
    type: setter
    variables:
      - key: persons
        scope: namespace
        value: jq(.)
        mimeType: application/json
