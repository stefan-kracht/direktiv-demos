direktiv_api: page/v1
type: page
blocks:
  - type: headline
    level: h1
    label: Crud Demo
  - type: query-provider
    queries:
      - id: persons
        url: /ns/demo/persons
        queryParams: []
    blocks:
      - type: headline
        level: h1
        label: "{{query.persons.total}} Persons"
      - type: table
        data:
          type: loop
          id: person
          data: query.persons.data
        actions: []
        columns:
          - type: table-column
            label: id
            content: "{{loop.person.id}}"
          - type: table-column
            label: first name
            content: "{{loop.person.first_name}}"
          - type: table-column
            label: last name
            content: "{{loop.person.first_name}}"
          - type: table-column
            label: email
            content: "{{loop.person.email}}"
      - type: loop
        id: person
        data: query.persons.data
        blocks:
          - type: card
            blocks:
              - type: headline
                level: h1
                label: headline {{loop.person.id}}
              - type: dialog
                trigger:
                  type: button
                  label: view details
                blocks:
                  - type: query-provider
                    queries:
                      - id: person
                        url: /ns/demo/person/{{loop.person.id}}
                        queryParams: []
                    blocks:
                      - type: headline
                        level: h1
                        label: This is {{query.person.data.first_name}}
                      - type: columns
                        blocks:
                          - type: column
                            blocks:
                              - type: image
                                src: "{{query.person.data.avatar}}"
                                width: 200
                                height: 200
                          - type: column
                            blocks:
                              - type: headline
                                level: h3
                                label: This is {{query.person.data.first_name}} {{query.person.data.last_name}}
                              - type: text
                                content: This is some random text.
  - type: columns
    blocks:
      - type: column
        blocks:
          - type: form
            trigger:
              type: button
              label: Seed Database
            mutation:
              id: seed-database
              method: POST
              url: /ns/demo/actions/seed-database
            blocks: []
      - type: column
        blocks:
          - type: form
            trigger:
              type: button
              label: Empty Persons Database
            mutation:
              id: empty-persons-database
              method: DELETE
              url: /ns/demo/delete-all-persons
            blocks: []
