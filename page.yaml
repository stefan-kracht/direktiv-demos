direktiv_api: page/v1
type: page
blocks:
  - type: card
    blocks:
      - type: dialog
        trigger:
          type: button
          label: Create Company
        blocks:
          - type: form
            trigger:
              type: button
              label: Search
            mutation:
              method: POST
              url: /ns/demo/company
            blocks:
              - type: headline
                level: h3
                label: Create Company
  - type: query-provider
    queries:
      - id: company-list
        url: /ns/demo/companies
        queryParams:
          - key: query
            value: my-search-query
    blocks:
      - type: headline
        level: h3
        label: Found {{query.company-list.total}} companies
      - type: dialog
        trigger:
          type: button
          label: Create Company
        blocks:
          - type: query-provider
            queries:
              - id: company-list2
                url: /ns/demo/companies/{{query.company-list.data.0.id}}
                queryParams:
                  - key: query
                    value: "{{query.company-list.data.0.id}}"
            blocks: []
      - type: table
        data:
          type: loop
          id: company
          data: query.company-list.data
          pageSize: 10
        blocks:
          - type: table-actions
            blocks:
              - type: dialog
                trigger:
                  type: button
                  label: Create new user
                blocks:
                  - type: headline
                    level: h2
                    label: create new user
              - type: dialog
                trigger:
                  type: button
                  label: Edit user permissions
                blocks:
                  - type: headline
                    level: h2
                    label: Edit user permissions
          - type: row-actions
            blocks:
              - type: dialog
                trigger:
                  type: button
                  label: Delete {{loop.company.name}}
                blocks:
                  - type: headline
                    level: h2
                    label: Delete {{loop.company.name}}
              - type: dialog
                trigger:
                  type: button
                  label: Edit {{loop.company.name}}
                blocks:
                  - type: headline
                    level: h2
                    label: Edit {{loop.company.name}}
        columns:
          - type: table-column
            label: "#"
            content: "{{loop.company.id}} of {{query.company-list.total}}"
          - type: table-column
            label: Company Name
            content: "{{loop.company.name}}"
